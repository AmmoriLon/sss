require: requirements.sc

theme: /

    state: Start
        q!: $regex</start>
        script:
            if ($request && $request.rawRequest && $request.rawRequest.message && $request.rawRequest.message.from && $request.rawRequest.message.from.username) {
                $client.username = "@"+$request.rawRequest.message.from.username;
            }
            # –∑–∞–ø–æ–º–∏–Ω–∞–µ–º user id 
            if ($request && $request.rawRequest && $request.rawRequest.message && $request.rawRequest.message.from && $request.rawRequest.message.from.id) {
                $client.user_id = $request.rawRequest.message.from.id
            }
        # —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
            $temp.var = setVariable();
        go!: /Greeting
    
    state: Greeting
        q!: * $greeting *
        script:
        a: –Ø –æ–∑–Ω–∞–∫–æ–º–ª—é —Å —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º –∑–∞–Ω—è—Ç–∏–π. \n–ü–æ–º–æ–≥—É –∏–∑—É—á–∏—Ç—å –≤–∏–¥–µ–æ–º–∞—Ç–µ—Ä–∏–∞–ª—ã, –Ω–∞–ø–æ–º–Ω—é –æ –∑–∞–Ω—è—Ç–∏—è—Ö. \n–û—Ç–ø—Ä–∞–≤–ª—é –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É. –ü–æ–∫–∞–∂—É –æ—Ü–µ–Ω–∫–∏ –∫—É—Ä–∞—Ç–æ—Ä–∞. \n–ü–æ–º–æ–≥—É —Å –Ω–∏–º —Å–≤—è–∑–∞—Ç—å—Å—è –ø–æ –∫–æ–º–∞–Ω–¥–µ "–∫—É—Ä–∞—Ç–æ—Ä".\n–ü—Ä–∏–º—É –æ–ø–ª–∞—Ç—É –∑–∞ —É—á–µ–±—É. \n–°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –≤—ã –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –°–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ. –û–Ω –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å–ª–æ–≤–æ–º "help" –∏–ª–∏ "–ø–æ–º–æ–≥–∏".\n–ò—Ç–∞–∫, –Ω–∞—á–Ω–µ–º.
        inlineButtons: 
            { text: "–ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ", callback_data: "Score"}
            { text: "–°–ø—Ä–∞–≤–æ—á–Ω–∏–∫", callback_data: "Help"}

    state: Help
        q!: * $help *
        script:
            $response.replies = $response.replies || [];
            $response.replies.push( {
                type: "image",
                imageUrl: links["help_picture"],
                text: "–û—Å–Ω–æ–≤–Ω–æ–µ —Ä–∞–±–æ—á–µ–µ –æ–∫–Ω–æ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫ üëÜ"
            });
        a: –≠—Ç–∞ –ª–∏–Ω–∏—èÔ∏è ‚¨õÔ∏è‚¨õÔ∏è‚¨õÔ∏è‚¨úÔ∏è‚¨úÔ∏è‚¨úÔ∏è–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å –≤–∞—à–µ–≥–æ –æ–±—É—á–µ–Ω–∏—è.
        a: –≠—Ç–∞ –ª–∏–Ω–∏—è üü©üü©üü©üü•üü•üü• –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞–±—Ä–∞–Ω–Ω—ã—Ö –±–∞–ª–ª–æ–≤ –∑–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ —Ä–∞–±–æ—Ç—ã.
        a: –ö–Ω–æ–ø–∫–∞–º–∏ "‚¨ÖÔ∏è –ù–∞–∑–∞–¥" –∏ "–í–ø–µ—Ä–µ–¥ ‚û°Ô∏è" –í—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å—Å—è –º–µ–∂–¥—É –≤–∏–¥–µ–æ—É—Ä–æ–∫–∞–º–∏. –ö–Ω–æ–ø–∫–∞ "–°–º–æ—Ç—Ä–µ—Ç—å ‚èØ" –¥–∞—Å—Ç –≤–∞–º —Å—Å—ã–ª–∫—É  –Ω–∞ –≤–∏–¥–µ–æ–ª–µ–∫—Ü–∏—é.
        a: –ö–Ω–æ–ø–∫–∞ "–°–∫–∞—á–∞—Ç—å PDF" –ø–æ–∑–≤–æ–ª–∏—Ç –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å–ø–µ–∫—Ç –æ—Ç–∫—Ä—ã—Ç–æ–π –≤ –æ–∫–Ω–µ –ª–µ–∫—Ü–∏–∏.
        a: –ö–Ω–æ–ø–∫–∞ "–°–¥–∞—Ç—å –î–ó" –ø–æ–∑–≤–æ–ª–∏—Ç –≤–∞–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø–æ –ø—Ä–æ–π–¥–µ–Ω–Ω–æ–º—É –º–∞—Ç–µ—Ä–∏–∞–ª—É –ª–µ–∫—Ü–∏–∏ –≤ –æ–∫–Ω–µ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É —Å–≤–æ–µ–º—É –∫—É—Ä–∞—Ç–æ—Ä—É. –ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫—É—Ä–∞—Ç–æ—Ä–æ–º –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –∞ –æ—Ü–µ–Ω–∫–∞ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è –≤ –Ω–∏–∂–Ω–µ–º –ø—Ä–∞–≤–æ–º —É–≥–ª—É. –ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∞—Å –Ω–µ —É—Å—Ç—Ä–æ–∏–ª, –≤—ã —Å–º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ—Å–¥–∞—Ç—å —Ä–∞–±–æ—Ç—É. –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± —ç—Ç–æ–º –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å—Å—è –Ω–∞ –∫–Ω–æ–ø–∫–µ. –î–ª—è —Å–≤—è–∑–∏ —Å –∫—É—Ä–∞—Ç–æ—Ä–æ–º –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –≤ —á–∞—Ç —Å–ª–æ–≤–æ "–∫—É—Ä–∞—Ç–æ—Ä".
    
            
        inlineButtons:
            { text: "–í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –æ–±—É—á–µ–Ω–∏—é", callback_data: "Score"}
        
        # —Å—Ç–µ–π—Ç —Å—á–∏—Ç–∞–µ—Ç –¥–æ 3-—Ö –ø–æ–ø–∞–¥–∞–Ω–∏–π –≤ noMatch –ø–æ–¥—Ä—è–¥
    state: NoMatch ||noContext = true
        event!: noMatch
        script:
            if ($session.lastState != "/NoMatch") {
                 $session.counter_err = 1;
                 $reactions.answer(selectRandomArg(["–ò–∑–≤–∏–Ω–∏—Ç–µ, —è –Ω–µ –ø–æ–Ω—è–ª", "–ü–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–≤–æ–π –≤–æ–ø—Ä–æ—Å"]));
            } else if ($session.counter_err < 2) {
                $session.counter_err += 1
                $reactions.answer(selectRandomArg(['–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —è –Ω–µ –ø–æ–Ω—è–ª (–Ω–∞–±–µ—Ä–∏—Ç–µ help –¥–ª—è –ø–æ–º–æ—â–∏)', '–í—ã —Å–∫–∞–∑–∞–ª–∏: "{{$request.query}}" - —è –Ω–µ –ø–æ–Ω—è–ª, –º–æ–∂–µ—Ç –Ω–∞–±–µ—Ä–µ—Ç–µ help?']));
            } else {
                $reactions.answer("–ò–∑–≤–∏–Ω–∏—Ç–µ, —è —Ç–∞–∫ –∏ –Ω–µ –ø–æ–Ω—è–ª –≤–∞—Å. \n–°–µ–π—á–∞—Å —è –æ—Ç–ø—Ä–∞–≤–ª—é –≤–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∫—É—Ä–∞—Ç–æ—Ä—É.");
                $reactions.transition("./Trouble");
            }
        # –ø–æ—Å–ª–µ —Ç—Ä–µ—Ç—å–µ–≥–æ noMatch –ø–æ–¥—Ä—è–¥ –±–æ—Ç –≥–æ—Ç–æ–≤ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç –∫—É—Ä–∞—Ç–æ—Ä–æ–≤ –æ –ø—Ä–æ–±–ª–µ–º–µ —É –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        state: Trouble
            q!: * $mentor *
            a:  –í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–µ–º –≤–∞—Å –≤–æ–ø—Ä–æ—Å–µ:
            
            state: sendTrouble
                event: noMatch
                script:
                    var message = "–£ —Å—Ç—É–¥–µ–Ω—Ç–∞ " + $client.username + " –µ—Å—Ç—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏: " + $request.query
                    $temp.response = sendMessageToMentor(message);
                    if ($temp.response) {
                        $reactions.answer("–í–∞—à–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞–Ω–æ –∫—É—Ä–∞—Ç–æ—Ä—É, –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è —Å –≤–∞–º–∏ —Å–≤—è–∂—É—Ç—Å—è");
                    } else {
                        $reactions.answer("–ö–∞–∫–∏–µ-—Ç–æ –ø–æ–º–µ—Ö–∏ –Ω–∞ –ª–∏–Ω–∏–∏, –ø—Ä–æ–¥—É–±–ª–∏—Ä—É–π—Ç–µ –ø–æ–∑–∂–µ");
                    }
                    $session.hw = $session.step;
                    $reactions.timeout({interval: 3, targetState: "/Score"});
                
            # —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –æ–±—Å—Ü–µ–Ω–Ω–æ–π –ª–µ–∫—Å–∏–∫–∏. –≤—Å–µ–≥–¥–∞ –Ω–∞–π–¥–µ–º, —á—Ç–æ –æ—Ç–≤–µ—Ç–∏—Ç—å —Ö–∞–º—É
    state: Obscene || noContext = true
        q!: * @mlps-obscene.obscene * 
        script:
            $temp.index = $reactions.random(answers.obscene.phrases.length);
        a: {{answers.obscene.phrases[$temp.index]}}